(window.webpackJsonp=window.webpackJsonp||[]).push([["topicData"],{"2Sqd":function(e,t,i){"use strict";i.r(t),i.d(t,"FollowState",(function(){return o.a})),i.d(t,"ResizeServiceImage",(function(){return d})),i.d(t,"TopicDataActions",(function(){return p.a})),i.d(t,"TopicDataConnector",(function(){return X})),i.d(t,"TopicDataReducer",(function(){return ee})),i.d(t,"TopicsFetchState",(function(){return s.a})),i.d(t,"ToolingInfo",(function(){return te})),i.d(t,"clearTopicsCache",(function(){return n.a})),i.d(t,"registerTopicsCacheAppErrorCallback",(function(){return n.e}));var o=i("uH2+"),s=i("FRpP"),n=i("6urM"),c=i("ADRF"),r=i("SNCn");var a;!function(e){e[e.LetterBox=1]="LetterBox",e[e.Scale=2]="Scale",e[e.Stretch=3]="Stretch",e[e.Crop=4]="Crop",e[e.FocalCrop=5]="FocalCrop",e[e.TmxResize=6]="TmxResize",e[e.AppExResize=7]="AppExResize",e[e.CustomCrop=8]="CustomCrop"}(a||(a={}));class d{constructor(e,t=0,i=0){this.url=e,this.height=t,this.width=i,this.mode=a.Crop,this.quality=60,this.url=(this.url||"").replace(/http:/,"https:").replace(/\?.*/,"")}static from(e){return e?new d(e.url,e.height,e.width):null}get src(){const e=[];return e.push({key:"w",value:Object(r.a)(this.width)}),e.push({key:"h",value:Object(r.a)(this.height)}),e.push({key:"m",value:Object(r.a)(this.mode)}),e.push({key:"q",value:Object(r.a)(this.quality)}),this.url+"?"+c.a.keyValueArrayToQueryString(e)}resizeTo(e,t){return this.width=t,this.height=e,this}}var l,p=i("FaCY"),u=i("D57K"),h=i("HxRh"),g=i("1w6q"),f=i("I6Lx"),b=i("ax+D"),T=i("dTwT"),m=i("XMd8"),v=i("tERu"),O=i("8X6I"),j=i("SSDD"),w=i("k112"),y=i("KUTD"),S=i("k3mM"),F=i("XLvf"),C=i("fuIx");!function(e){e.SysTag="SysTag",e.UserQuery="UserQuery"}(l||(l={}));var I,R=i("u5KZ"),A=i("C8K2");!function(e){e.topicCardBackupImageUrl="https://img-s-msn-com.akamaized.net/tenant/amp/entityid/AAtCmK3.img";e.TopicCardStandardDimensions={borderWidth:4,height:250,width:250,gutterSize:A.a},e.TopicCardImageStandardDimensions={height:242,width:242}}(I||(I={}));const k="feeds";var E=i("y+Kz"),U=i("rvYQ"),M=i("6ADy"),D=i("msIb"),L=i("KETb"),P=i("hxZq"),K=i("hDMs"),q=i("MptA"),x=i("NuVg"),G=i("tMmC");class N{static TranslateToTopicGroups(e,t){if(G.a.logObjects(e),!b.a.isDefined(e)||!N.isValidCompositeCardResponse(e.value))throw new Error("Topics OneService response schema validation error: no valid topic groups found!");const i={topicGroupIds:[],topicGroupMap:{},topicMap:{}};return e.value[0].subCards.forEach(e=>{if(N.isValidTopicGroup(e,!0)){const o=N.getTopics(e,t);b.a.arrayHasData(o)&&(o.forEach(e=>{i.topicMap[e.id]=e}),i.topicGroupMap[e.id]={id:e.id,nextPageUrl:e.nextPageUrl,title:e.title,topicIds:o.map(e=>e.id)},i.topicGroupIds.push(e.id))}}),i}static TranslateToRecommendedTopics(e){if(G.a.logObjects(e),!b.a.isDefined(e)&&e.value)throw new Error("Topics OneService response schema validation error: no valid topic group found!");return e.value.map(e=>{const t=Object.assign(Object.assign({},e),{name:e.title,feedType:null});return N.getTopic(t,null)})}static TranslateSingleTopicResponseToTopic(e){if(!b.a.isDefined(e)||!N.isValidCompositeCardResponse(e.value))throw new Error("Topics OneService response schema validation error: no valid followed topics found!");const t=e.value[0].subCards;return N.getTopic(t[0],null)}static TranslateToFollowedTopics(e){if(G.a.logObjects(e),!b.a.isDefined(e)||!b.a.arrayHasData(e.value))throw new Error("Topics OneService response schema validation error: no valid followed topics found!");const t=e.value,i={};return t.forEach(e=>{if(e&&e.id){const t={};t[e.id]=[{followState:"followed"}],e.title&&(e.name=e.title,delete e.title);const o=N.getTopic(e,t);i[o.id]=o}}),i}static getTopic(e,t,i){if(!Object(q.a)(e.id)||!Object(q.a)(e.name))return null;let s;if(s=t&&b.a.arrayHasData(t[e.id])?t[e.id][0]:{followState:o.a.Unfollowed},!b.a.isDefined(s))return null;i||(i=I.TopicCardImageStandardDimensions);const n=e.image,c=n&&n.url?d.from(n).resizeTo(i.height,i.width).src:I.topicCardBackupImageUrl;return{id:e.id,name:e.name,followState:s.followState===o.a.Unfollowed||s.followState===o.a.None?o.a.Unfollowed:o.a.Followed,imgSrc:c,href:K.a.generateTopicLink(e.id,e.name),feedType:e.feedType,canonicalName:e.canonicalName,isInferred:e.isInferred,branding:e.branding}}static getTopics(e,t){const i=[];return e.subCards.forEach(o=>{const s=N.getTopic(o,e.metadata,t);i.push(s)}),i}static isValidTopicGroup(e,t){return(!t||Object(q.a)(e.id))&&!Object(x.a)(e.metadata)&&b.a.arrayHasData(e.subCards)}static isValidCompositeCardResponse(e){return b.a.arrayHasData(e)&&b.a.arrayHasData(e[0].subCards)}}var Q=i("/+Un"),z=i("YI90"),$=i("e8jz"),H=i("CzGr"),V=i("Zsg4");class B{constructor(e){this.fetchImpl=e}getFollowedTopics(e,t){return Object(u.b)(this,void 0,void 0,(function*(){const i=yield this.getRequestInit(),o=yield this.getCommonParams(k),s=Object(C.b)()?null:Object(P.b)(),n=[...o,{key:E.v.queryType,value:"MyFeed"},{key:E.v.top,value:"1000"},{key:"allTopics",value:"true"},{key:"rndId",value:e?Object(z.a)(0,1e3).toString():null},{key:P.a,value:s?s.toString():null},{key:E.v.responseSchema,value:"cardView"}];t&&n.push({key:"$orderby",value:"createdDateTime desc"});const c=this.getLocationData();c&&!Object(C.b)()&&n.push({key:E.v.location,value:c});const r=Object(M.d)("msn/topics");this.appendQs(n,r);const a=yield this.sendRequest(decodeURIComponent(r.href),i,"getUserTopics");return N.TranslateToFollowedTopics(a)}))}getRecommendedTopics(){return Object(u.b)(this,void 0,void 0,(function*(){const e=yield this.getRequestInit(),t=[...yield this.getCommonParams(k),{key:E.v.queryType,value:"recommendations"},{key:E.v.select,value:"id,title,image"}],i=Object(M.d)("msn/topics/me/recommendations");this.appendQs(t,i);const o=yield this.sendRequest(decodeURIComponent(i.href),e,"getRecommendedTopics");return N.TranslateToRecommendedTopics(o)}))}getRelatedTopics(e,t){return Object(u.b)(this,void 0,void 0,(function*(){const i=Object(M.d)("news/topics/{id}/related".replace("{id}",e)),o=yield this.getCommonParams(k);t&&t>0&&o.push({key:E.v.top,value:t.toString()}),this.appendQs(o,i);const s=yield this.getRequestInit(),n=yield this.sendRequest(decodeURIComponent(i.href),s,"getRelatedTopics");return n&&0===n.length?n:N.TranslateToRecommendedTopics(n)}))}getTopics(e,t){return Object(u.b)(this,void 0,void 0,(function*(){const i=yield this.getRequestInit(),o=yield this.getCommonParams(k),s=t||[...o,{key:E.v.queryType,value:"Discover"},{key:E.v.top,value:"100"},{key:E.v.select,value:"id,name,image,feedType,canonicalName,branding"}],n=this.getLocationData();n&&s.push({key:E.v.location,value:n});const c=Object(M.d)("msn/topics");this.appendQs(s,c);const r=yield this.sendRequest(decodeURIComponent(c.href),i,"getTopicGroups");return N.TranslateToTopicGroups(r,e)}))}getTopic(e){return Object(u.b)(this,void 0,void 0,(function*(){const t=yield this.getRequestInit(),i=[...yield this.getCommonParams(k),{key:E.v.ids,value:e}],o=this.getLocationData();o&&i.push({key:E.v.location,value:o});const s=Object(M.d)("msn/topics");this.appendQs(i,s);const n=yield this.sendRequest(decodeURIComponent(s.href),t,"getTopic");return N.TranslateSingleTopicResponseToTopic(n)}))}updateTopicFollowingState(e,t,i){return Object(u.b)(this,void 0,void 0,(function*(){const o=Object(M.d)("Graph/Actions"),s=yield this.getRequestInit(),n=yield this.getCommonParams(k),c=this.getLocationData();if(c&&n.push({key:E.v.location,value:c}),t){const t={actionType:"Follow"};e?t.targetId=e:i&&(t.definitionName=i),s.method="POST",s.headers["Content-Type"]="text/json",s.body=JSON.stringify(t),this.appendQs(n,o)}else{const t={key:E.v.filter,value:`actionType eq 'Follow' and (targetId eq '${e}')`};s.method="DELETE";const i=[t,...n];this.appendQs(i,o)}return yield this.sendRequest(decodeURIComponent(o.href),s,"updateTopicFollowingState")}))}restoreDefaultTopics(){return Object(u.b)(this,void 0,void 0,(function*(){const e=Object(M.d)("Graph/Actions"),t=yield this.getRequestInit();t.method="DELETE";const i=[...yield this.getCommonParams(k),{key:E.v.filter,value:"actionType eq 'Follow'"}];this.appendQs(i,e);return yield this.sendRequest(decodeURIComponent(e.href),t,"restoreDefaultTopics")}))}getLocationData(){const e=Object(f.a)();return e.ClientSettings&&e.ClientSettings.geo_lat&&e.ClientSettings.geo_long?`${e.ClientSettings.geo_lat}|${e.ClientSettings.geo_long}`:null}getCommonParams(e){return Object(u.b)(this,void 0,void 0,(function*(){if(Object(C.b)())return this.getSapphireQueryParams();return(yield this.isUserSignedIn())?D.a.getOneServiceParamsWithAuth(U.a.UserId,e):D.a.getOneServiceParamsWithoutAuth(U.a.UserId,e)}))}getSapphireQueryParams(){const e=D.a.getOneServiceNonDynamicParamsWithoutAuth(k),t=Object($.b)();return t&&(e.push({key:E.v.market,value:t.market}),e.push({key:E.v.fdhead,value:t.features}),e.push({key:E.v.activityId,value:t.activityId}),t.latitude&&t.longitude&&e.push({key:E.v.location,value:`${t.latitude}|${t.longitude}`})),e}getRequestInit(e=null){return Object(u.b)(this,void 0,void 0,(function*(){return null==e&&(e={method:"GET"}),(yield this.isUserSignedIn())&&(e.credentials="include"),e.headers=Object(C.b)()?yield Object(H.a)():yield D.a.getOneServiceHeaders(),e}))}isUserSignedIn(){return Object(u.b)(this,void 0,void 0,(function*(){const e=Object(f.a)().UserIsSignedIn;if(void 0!==e)return e;return(yield Object(Q.b)())===v.c.SignedIn}))}sendRequest(e,t,i){return Object(u.b)(this,void 0,void 0,(function*(){return Object(C.b)()?yield this.saphireRequest(decodeURIComponent(e),t):yield this.networkRequest(decodeURIComponent(e),t,i)}))}saphireRequest(e,t){return Object(u.b)(this,void 0,void 0,(function*(){const i={url:e,headers:t.headers,body:t.body,refresh:!0};switch(t.method){case"POST":return Object(V.i)(i);case"DELETE":return Object(V.a)(i);default:return Object(V.c)(i)}}))}networkRequest(e,t,i){return Object(u.b)(this,void 0,void 0,(function*(){return Object(L.a)(()=>Object(u.b)(this,void 0,void 0,(function*(){const i=yield this.fetchImpl(e,t);if(!i.ok)throw Error(i.statusText);return 204===i.status?[]:i.json()})),i)}))}appendQs(e,t){e.forEach(e=>{e.value&&t.searchParams.set(e.key,e.value)})}}var Z=i("HDSB"),J=i("PZnQ"),W=i("pMIE");class X extends g.a{constructor(e,t,i,o,s,c,r){super(e,t,i,o,s,c,r),this.fetchedAllFollowedTopics=!1,this.fetchedAllRecommendedTopics=!1,this.fetchedAllTopics=!1,Object(Z.a)()?(this.serviceClient=new B(window.fetch.bind(window)),this.followedTopicsListKey=Object(n.b)("followedTopics")):this.serviceClient=new B(fetch),this.trackAppErrorEventCallback=R.a?R.a.sendAppErrorEvent:null,this.useUserCreatedOrder=Object(f.a)().CurrentFlights.indexOf("prg-navfr-t")>-1}registerTrackAppErrorEventCallback(e){this.trackAppErrorEventCallback=e}followTopic(e,t){return Object(u.b)(this,void 0,void 0,(function*(){const i=b.a.isNotNullOrUndefined(yield this.getFollowedTopic(e,t));return i&&(Object(w.a)(y.a.InterestsChange),Object(O.c)(j.a.InterestsChange),Object(C.b)()||Object(P.d)()),i}))}getFollowedTopic(e,t){return Object(u.b)(this,void 0,void 0,(function*(){let i=null;return e&&(i=yield this.getTopic(e)),(!Object(F.isNullOrUndefined)(i)&&i.followState!==o.a.Followed||t)&&(e=i&&i.feedType!==l.UserQuery?e:null,t=i&&i.feedType===l.UserQuery?i.name:t,(yield this.updateTopicFollowingState(e,o.a.Followed,t))&&(i=yield this.getTopic(e),!Object(C.b)()&&(yield Object(n.g)(i,!0,this.followedTopicsListKey)))),Object(F.isNullOrUndefined)(i)||i.followState!==o.a.Followed?void 0:i}))}getFollowedTopics(e){return Object(u.b)(this,void 0,void 0,(function*(){let t=this.getCurrentState().followedTopicIds;return this.fetchedAllFollowedTopics&&!e||(e=e||(yield this.gettingTopicsAfterMigration()),(yield this.fetchFollowedTopics(e))&&(t=this.getCurrentState().followedTopicIds,e&&!Object(C.b)()&&Object(J.d)())),t}))}getOneServiceFollowedTopics(){return Object(u.b)(this,void 0,void 0,(function*(){try{return yield this.serviceClient.getFollowedTopics(!1,this.useUserCreatedOrder)}catch(e){this.trackAppError(Object.assign(Object.assign({},h.Kb.InterestsRetrieveFollowedTopicsError),{message:"Failed fetching one service followed topics",pb:Object.assign(Object.assign({},h.Kb.InterestsRetrieveFollowedTopicsError.pb),{customMessage:"Failed fetching one service followed topics. "+(e&&e.message)})}))}}))}getRecommendedTopics(){return Object(u.b)(this,void 0,void 0,(function*(){return this.fetchedAllRecommendedTopics||(yield this.fetchRecommendedTopics()),this.getCurrentState().recommendedTopics}))}getRelatedTopics(e,t){return Object(u.b)(this,void 0,void 0,(function*(){return this.serviceClient.getRelatedTopics(e,t)}))}getNextTopicsInList(e=null){return Object(u.b)(this,void 0,void 0,(function*(){let t=this.getCurrentState().topicListMap[e];return!Object(F.isUndefined)(t)&&Object(F.isString)(t.nextPageUrl)&&(yield this.fetchTopicGroup(e))&&(t=this.getCurrentState().topicListMap[e]),t}))}getTopic(e){return Object(u.b)(this,void 0,void 0,(function*(){let t=this.getCurrentState().topicMap[e];return Object(F.isUndefined)(t)&&(yield this.fetchTopic(e))&&(t=this.getCurrentState().topicMap[e]),t}))}getTopics(e){return Object(u.b)(this,void 0,void 0,(function*(){return this.fetchedAllTopics||(yield this.fetchTopics(e)),this.getCurrentState().topicMap}))}unfollowTopic(e,t){return Object(u.b)(this,void 0,void 0,(function*(){let i=yield this.updateTopicFollowingState(e,o.a.Unfollowed,null,t);if(i&&!t){Object(w.a)(y.a.InterestsChange),Object(O.c)(j.a.InterestsChange),Object(C.b)()||Object(P.d)();const t=yield this.getTopic(e);Object(Z.a)()&&!Object(C.b)()&&(i=yield Object(n.g)(t,!1,this.followedTopicsListKey))}return i}))}restoreDefaultTopics(){return Object(u.b)(this,void 0,void 0,(function*(){try{return yield this.serviceClient.restoreDefaultTopics(),Object(w.a)(y.a.InterestsChange),Object(O.c)(j.a.InterestsChange),Object(C.b)()||Object(P.d)(),yield S.b.purgeCacheAsync(S.a.followedTopics),yield this.getFollowedTopics(!0),!0}catch(e){return this.trackAppError(Object.assign(Object.assign({},h.Kb.FailedRestoringDefaultTopicsError),{message:"Failed restoring default set of followed interests",pb:Object.assign(Object.assign({},h.Kb.FailedRestoringDefaultTopicsError.pb),{customMessage:"Error: "+(e&&e.message)})})),!1}}))}fetchFollowedTopics(e){return Object(u.b)(this,void 0,void 0,(function*(){try{let t;e||!Object(Z.a)()||Object(C.b)()||(yield Object(n.d)(this.followedTopicsListKey),t=yield Object(n.c)(this.followedTopicsListKey));const i=t||(yield this.serviceClient.getFollowedTopics(e,this.useUserCreatedOrder));return t||(yield Object(n.f)(this.followedTopicsListKey,i,!0)),p.a.followedTopics.getActionSender(this).send(i,e),this.fetchedAllFollowedTopics=!0,!0}catch(e){return p.a.followedTopicsFailed.getActionSender(this).send(),this.trackAppError(Object.assign(Object.assign({},h.Kb.InterestsRetrieveFollowedTopicsError),{message:"Failed fetching followed topics",pb:Object.assign(Object.assign({},h.Kb.InterestsRetrieveFollowedTopicsError.pb),{customMessage:"Failed fetching followed topics. "+(e&&e.message)})})),!1}}))}fetchRecommendedTopics(){return Object(u.b)(this,void 0,void 0,(function*(){try{const e=yield this.serviceClient.getRecommendedTopics();return p.a.recommendedTopics.getActionSender(this).send(Object(W.a)(e)),this.fetchedAllRecommendedTopics=!0,!0}catch(e){return p.a.recommendedTopicsFailed.getActionSender(this).send(),this.trackAppError(Object.assign(Object.assign({},h.Kb.InterestsRetrieveRecommendedTopicsError),{message:"Failed fetching recommended topics",pb:Object.assign(Object.assign({},h.Kb.InterestsRetrieveRecommendedTopicsError.pb),{customMessage:"Failed fetching recommended topics. "+(e&&e.message)})})),!1}}))}fetchTopic(e){return Object(u.b)(this,void 0,void 0,(function*(){try{const t=yield this.serviceClient.getTopic(e),i=this.getCurrentState().topicMap[e];return(Object(F.isUndefined)(i)||i.followState!==t.followState)&&p.a.topic.getActionSender(this).send(t),!0}catch(t){return p.a.followedTopicsFailed.getActionSender(this).send(),this.trackAppError(Object.assign(Object.assign({},h.Kb.InterestsRetrieveTopicsError),{message:"Failed to fetch topic.",pb:Object.assign(Object.assign({},h.Kb.InterestsRetrieveTopicsError.pb),{customMessage:`Failed to fetch topic ${e}. ${t&&t.message}`})})),!1}}))}fetchTopicGroup(e){return Object(u.b)(this,void 0,void 0,(function*(){if(!e)return!1;const t=this.getCurrentState().topicListMap[e],i=Object(F.isUndefined)(t)||t.nextPageUrl;if(!Object(F.isString)(i))return!1;const o=c.a.getParamsFromUrl(i);if(null===o)return!1;try{const t=yield this.serviceClient.getTopics(null,o);return p.a.topicGroup.getActionSender(this).send(t.topicGroupMap[e],t.topicMap),!0}catch(t){return p.a.topicGroupFailed.getActionSender(this).send(e),this.trackAppError(Object.assign(Object.assign({},h.Kb.InterestsRetrieveTopicsError),{message:"Failed to get topics list.",pb:Object.assign(Object.assign({},h.Kb.InterestsRetrieveTopicsError.pb),{customMessage:`Failed to get topics list ${e}. ${t&&t.message}`})})),!1}}))}fetchTopics(e){return Object(u.b)(this,void 0,void 0,(function*(){try{const t=yield this.serviceClient.getTopics(e);return p.a.topics.getActionSender(this).send(t),this.fetchedAllTopics=!0,!0}catch(e){return p.a.topicsFailed.getActionSender(this).send(),this.trackAppError(Object.assign(Object.assign({},h.Kb.InterestsRetrieveTopicsError),{message:"Failed fetching topics.",pb:Object.assign(Object.assign({},h.Kb.InterestsRetrieveTopicsError.pb),{customMessage:"Failed fetching topics. "+(e&&e.message)})})),!1}}))}updateTopicFollowingState(e,t,i,s){return Object(u.b)(this,void 0,void 0,(function*(){try{return yield this.serviceClient.updateTopicFollowingState(e,t!==o.a.Unfollowed,i),s?!0:(yield S.b.purgeCacheAsync(S.a.followedTopics),Object(F.isNullOrUndefined)(e)&&t!==o.a.Unfollowed?this.getFollowedTopics(!0):p.a.updateTopicFollowedState.getActionSender(this).send(e,t,this.useUserCreatedOrder),!0)}catch(i){return p.a.updateTopicFollowedStateFailed.getActionSender(this).send(e,t),this.trackAppError(Object.assign(Object.assign({},t?h.Kb.InterestsFollowTopicError:h.Kb.InterestsUnfollowTopicError),{message:"Failed to update topic followed state.",pb:Object.assign(Object.assign({},t?h.Kb.InterestsFollowTopicError.pb:h.Kb.InterestsUnfollowTopicError.pb),{customMessage:`Failed to update followed state to ${t} for ${e}. ${i&&i.message}`})})),!1}}))}gettingTopicsAfterMigration(){return Object(u.b)(this,void 0,void 0,(function*(){return!(!T.a.getItem(m.a.InterestsNeedRefresh)||(yield Object(Q.b)())!==v.c.SignedIn)&&(T.a.removeItem(m.a.InterestsNeedRefresh),!0)}))}trackAppError(e){this.trackAppErrorEventCallback&&this.trackAppErrorEventCallback(Object.assign(Object.assign({},e),{source:"TopicData.connector.ts"}))}}var Y=i("05Au"),_=i("Z+pL");class ee{reduce(e,t){if(!e)return{followedTopicIds:[],recommendedTopics:[],topicListIds:[],topicListMap:{},topicMap:{},topicsFetchState:s.a.InProgress};if(!t)return e;let i,n=!1;return n=n||Y.a.handleAction(t,p.a.followedTopics,(t,o)=>{if(!t)return;const n=Object.assign({},e.topicMap);i=Object.assign(Object.assign({},e),{topicMap:n,topicsFetchState:s.a.Loaded});const c=[];Object.keys(t).forEach(e=>{c.push(e);const i=t[e];n[e]=i}),i.followedTopicIds=o?c:Object(_.a)(i.followedTopicIds,c),this.updateFollowState(i)}),n=n||Y.a.handleAction(t,p.a.recommendedTopics,t=>{if(!t)return;const o=Object.assign({},e.topicMap);t.forEach(e=>{o[e.id]||(o[e.id]=e)}),i=Object.assign(Object.assign({},e),{recommendedTopics:t,topicMap:o,topicsFetchState:s.a.Loaded}),this.updateFollowState(i)}),n=n||Y.a.handleAction(t,p.a.topic,t=>{const o=Object.assign({},e.topicMap);o[t.id]=t,i=Object.assign(Object.assign({},e),{topicMap:o,topicsFetchState:s.a.Loaded})}),n=n||Y.a.handleAction(t,p.a.topics,t=>{if(!t)return;const o=Object.assign({},e.topicMap);Object.keys(t.topicMap).forEach(i=>{const s=e.topicMap[i];o[i]=Object.assign(Object.assign({},t.topicMap[i]),{isInferred:s&&s.isInferred})}),i=Object.assign(Object.assign({},e),{topicListIds:t.topicGroupIds,topicListMap:t.topicGroupMap,topicMap:o,topicsFetchState:s.a.Loaded}),this.updateFollowState(i)}),n=n||Y.a.handleAction(t,p.a.topicGroup,(t,o)=>{if(!t||!t.topicIds||0===t.topicIds.length||!o)return;const n=Object.assign({},e.topicListMap),c=Object.assign({},e.topicMap),r=n[t.id];t.nextPageUrl&&(r.nextPageUrl=t.nextPageUrl),r&&r.topicIds&&(r.topicIds=Object(_.a)(r.topicIds,t.topicIds)),t.topicIds.forEach(e=>{c[e]=o[e]}),i=Object.assign(Object.assign({},e),{topicListMap:n,topicMap:c,topicsFetchState:s.a.Loaded}),this.updateFollowState(i)}),n=n||Y.a.handleAction(t,p.a.updateTopicFollowedState,(t,s,n)=>{const c=Object.assign({},e.topicMap),r=e.followedTopicIds.slice(),a=e.topicMap[t];if(s!==o.a.Unfollowed){if(Object(x.a)(a)){const e={followState:o.a.Followed,id:t,name:""};c[t]=e}else{if(a.followState===o.a.Followed)return;c[t].followState=o.a.Followed,i=Object.assign(Object.assign({},e),{topicMap:c})}n?r.unshift(t):r.push(t)}else{if(Object(x.a)(a))return;c[t].followState=o.a.Unfollowed;const e=r.indexOf(t);r.splice(e,1)}const d=e.recommendedTopics.map(e=>Object.assign(Object.assign({},e),{followState:e.id===t?s:e.followState}));i=Object.assign(Object.assign({},e),{followedTopicIds:r,topicMap:c,recommendedTopics:d})}),n=n||Y.a.handleAction(t,p.a.recommendedTopicsFailed,()=>{i=Object.assign(Object.assign({},e),{topicsFetchState:s.a.Failed})}),n=n||Y.a.handleAction(t,p.a.followedTopicsFailed,()=>{i=Object.assign(Object.assign({},e),{topicsFetchState:s.a.Failed})}),i||e}updateFollowState(e){const{followedTopicIds:t}=e;Object.keys(e.topicMap).forEach(i=>{const s=e.topicMap[i];s&&(s.followState=t.includes(i)?o.a.Followed:o.a.Unfollowed)}),e.recommendedTopics.forEach(e=>{e.followState=t.includes(e.id)?o.a.Followed:o.a.Unfollowed})}}const te={experienceConfigSchema:{}}},CzGr:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var o=i("D57K"),s=(i("Zsg4"),i("e8jz"));function n(){return Object(o.b)(this,void 0,void 0,(function*(){const e={},t=Object(s.b)();if(t){e.MUID=t.muid;const i=yield Object(s.a)("service::api.msn.com::MBI_SSL");"MSA"===t.accountType&&i?e.UserAuthToken=i:"AAD"===t.accountType&&i&&(e.Authorization=i)}return e}))}},FRpP:function(e,t,i){"use strict";var o;i.d(t,"a",(function(){return o})),function(e){e[e.InProgress=0]="InProgress",e[e.Loaded=1]="Loaded",e[e.Failed=2]="Failed"}(o||(o={}))},FaCY:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var o=i("G82u");class s{}s.followedTopics=new o.a("FollowedTopics"),s.followedTopicsFailed=new o.a("FollowedTopicsFailedSignature"),s.recommendedTopics=new o.a("RecommendedTopics"),s.recommendedTopicsFailed=new o.a("RecommendedTopicsFailed"),s.topic=new o.a("Topic"),s.topicFailed=new o.a("TopicsFailed"),s.topics=new o.a("Topics"),s.topicsFailed=new o.a("TopicsFailed"),s.topicGroup=new o.a("TopicGroup"),s.topicGroupFailed=new o.a("TopicGroupFailed"),s.updateTopicFollowedState=new o.a("UpdateTopicFollowedState"),s.updateTopicFollowedStateFailed=new o.a("UpdateTopicFollowedStateFailed")},XMd8:function(e,t,i){"use strict";var o;i.d(t,"a",(function(){return o})),function(e){e.InterestsNeedRefresh="interests-need-refresh"}(o||(o={}))},e8jz:function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return a}));var o=i("D57K"),s=i("Zsg4");let n,c;function r(){return c}function a(e){return Object(o.b)(this,void 0,void 0,(function*(){if(n.isSignedIn&&"AAD"===n.accountType){const e=yield Object(s.e)({refresh:!0,accountType:"AAD"});try{const t=JSON.parse(e);if(t.accessToken&&t.accessToken.length>0)return"Bearer "+t.accessToken}catch(e){console.error("SapphireUserConfig.getAccessToken: Failed to parse AAD access token")}}if(n.isSignedIn&&"MSA"===n.accountType){const t=yield Object(s.e)({refresh:!0,accountType:"MSA",type:"AccessToken",scope:e});try{const e=JSON.parse(t);if(e.succeed)return e.accessToken}catch(e){console.error("SapphireUserConfig.getAccessToken: Failed to parse MSA access token")}}return null}))}},hDMs:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var o,s=i("ADRF"),n=i("rvYQ");!function(e){e.contentUrlPrefixLookup={article:"ar",video:"vi",slideshow:"ss"},e.generateTopicLink=function(e,t){const i=s.a.encodeURIComponentForPrime(t).toLowerCase(),{HostPage:o}=n.a;if(o){const t=new URL(o.originalUrl);return t.origin+"/"+o.verticalKey+"/"+o.categoryKey+"/interests/"+i+"/"+n.a.CurrentMarket+"/f-"+e+t.search}return"https://www.msn.com"},e.generateContentLink=function(t,i,o,s,c){return t&&i&&o&&s&&c?`/${n.a.CurrentMarket}/${t}/${i}/${s}/${e.contentUrlPrefixLookup[c]}-${o}`:"/"}}(o||(o={}))},hxZq:function(e,t,i){"use strict";i.d(t,"a",(function(){return h})),i.d(t,"d",(function(){return g})),i.d(t,"b",(function(){return f})),i.d(t,"c",(function(){return b}));var o=i("pAXR"),s=i("k3mM"),n=i("rvYQ"),c=i("zfSW"),r=i("s9+9"),a=i("HxRh"),d=i("9J8d"),l=i("u5KZ"),p=i("l+Jz"),u=i("tWvP");const h="cbypass";function g(){const e=d.a.getInstance().rootReducer.connector(r.a.OneServiceContent);if(!e)return void(l.a&&l.a.sendAppErrorEvent(a.nc.FailedToUpdateBypassValueConnectorNotInitialized));const t=Date.now();return Object(u.a)(h,t.toString(),10/1440,n.a.HostPage.topDomain,"/"),o.a.updateCacheBypassValue.getActionSender(e).send(t),s.b.purgeCacheAsync(s.a.river).then(()=>{Object(c.c)({id:p.a.UpdateMyFeed,payload:t})})}function f(){const e=d.a.getInstance().rootReducer.connector(r.a.OneServiceContent);return e?e.getCurrentState().cacheBypassValue:0}function b(e){const t=f();t>0&&e.searchParams.set(h,t.toString())}},pAXR:function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return n}));var o=i("G82u");class s{}function n(){s.updateCacheBypassValue.unregisterObservers()}s.updateCacheBypassValue=new o.a("UpdateCacheBypassValue")},"uH2+":function(e,t,i){"use strict";var o;i.d(t,"a",(function(){return o})),function(e){e.Followed="followed",e.Unfollowed="unfollowed",e.Locked="locked",e.None="none"}(o||(o={}))}}]);