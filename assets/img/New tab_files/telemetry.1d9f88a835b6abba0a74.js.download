(window.webpackJsonp=window.webpackJsonp||[]).push([["telemetry"],{C4R5:function(e,t,o){"use strict";o.d(t,"c",(function(){return g})),o.d(t,"e",(function(){return y})),o.d(t,"b",(function(){return p})),o.d(t,"a",(function(){return f})),o.d(t,"d",(function(){return P}));var i,a=o("D57K"),n=o("9J8d"),c=o("FaCY"),s=o("s9+9"),r=o("rvYQ"),d=o("Z3LZ");class l{constructor(e,t){this.onUpdateFollowedTopics=()=>{if(!this.connector)return this.onRouteUpdateCallback([]);const e=this.connector.getCurrentState(),t=e.followedTopicIds,o=e.topicMap,a=[];t&&o&&t.forEach(e=>{const t=o[e],n={path:g(t.canonicalName||t.name,e),display:t.name,experienceInfo:this.dynamicRouteExperienceInfo,context:{feedId:e},pivotId:e,dynamicPivotSource:i.TopicsData};a.push(n)}),this.onRouteUpdateCallback(a)},this.onRouteUpdateCallback=e,this.dynamicRouteExperienceInfo=t}getDynamicPivotsFromDataConnector(e){return Object(a.b)(this,void 0,void 0,(function*(){switch(e){case s.a.TopicData:yield this.getPivotsFromTopicData();break;case s.a.NavigationData:yield this.getPivotsFromNavigationData();break;default:return}}))}getPivotsFromTopicData(){return Object(a.b)(this,void 0,void 0,(function*(){yield Object(d.l)(),n.a.getInstance().rootReducer.getDataConnector(s.a.TopicData).then(e=>{this.connector=e,this.connector.getFollowedTopics(!1).then(()=>{this.onUpdateFollowedTopics()})}),c.a.followedTopics.registerObserver(this.onUpdateFollowedTopics),c.a.updateTopicFollowedState.registerObserver(this.onUpdateFollowedTopics)}))}getPivotsFromNavigationData(){return Object(a.b)(this,void 0,void 0,(function*(){if(this.connector=yield n.a.getInstance().rootReducer.getDataConnector(s.a.NavigationData),this.connector){const e=yield this.connector.getNavigationItems(r.a.HostPage.verticalKey,r.a.HostPage.categoryKey);this.onRouteUpdateCallback(this.mapNavigationItemsToDynamicRoutes(e))}else this.onRouteUpdateCallback([])}))}mapNavigationItemsToDynamicRoutes(e){return e.map(e=>({path:e.targetUrl,externalUrl:e.targetUrl,display:e.displayText,pivotId:e.categoryKey,dynamicPivotSource:i.NavigationData}))}}!function(e){e.NavigationData="NavigationDataAdapter",e.TopicsData="TopicsDataAdapter"}(i||(i={}));var p,u=o("b2pY"),h=o("dTwT");class m{constructor(e){this.staticRoutes=[],this.dynamicRoutes=[],this.onUpdateRoutesCallbacks=[],this.switchListeners=[],this.callSwitchListeners=e=>{if(!this.switchListeners.length)return;const t=this.getPivotSelectionInfoFromPath(e.state&&e.state.previousPath),o=this.getPivotSelectionInfoFromPath(e.pathname),i={newSelection:o,oldSelection:t};this.config.enableRememberedPivots&&h.a.setItem(w,o&&o.pivotId),this.switchListeners.sort((e,t)=>e.order-t.order);for(const e of this.switchListeners)e.callback(i)},e&&this.setRoutes(e),u.a.listen(this.callSwitchListeners)}setRoutes(e){this.config=e,this.setStaticRoutes(),this.config.disableLoadingDynamicRoutes||this.setDynamicRoutes()}pushHistory(e,t,o,i){const a=u.a.location.pathname;u.a.push(g(e,t),{previousPath:a,context:o},i)}getStaticRoutes(){return this.staticRoutes}getDynamicRoutes(){return this.dynamicRoutes}getDynamicRoute(){return{path:f.interest,experienceInfo:this.config.dynamicRouteExperienceInfo,pivotId:"oneriver.xfeed"}}getCurrentRoute(){const e=u.a.location.pathname,t=this.staticRoutes.find(t=>t.path===e);return t||(e.includes("/interest")?this.getDynamicRoute():null)}addDynamicRouteListener(e){this.onUpdateRoutesCallbacks.push(e)}addSwitchListener(e,t=v.AfterLoadContent){this.switchListeners.push({callback:e,order:t})}getRememberedPivot(){if(!this.config.enableRememberedPivots)return;const e=h.a.getItem(w);e&&this.config.staticRoutes.forEach(t=>{t.pivotId===e&&this.pushHistory(t.canonicalName)})}getPivotSelectionInfoFromPath(e){if(!e)return null;const t=this.config.staticRoutes.find(t=>g(t.canonicalName)===e);if(t)return{pivotId:t.pivotId,telemetryPageName:t.telemetryPageName,telemetryPivotCategory:t.telemetryPivotCategory,display:t.canonicalName};if(0===e.indexOf("/interest")){const t=e.split("/");let o=void 0;return t.length>=4&&(o="null"===t[3]?t[2]:t[3]),{pivotId:o,telemetryPageName:"xfeed",telemetryPivotCategory:"news",display:t.length>=3&&t[2]}}return null}setStaticRoutes(){const{staticRoutes:e}=this.config;e.forEach(e=>{const t={path:g(e.canonicalName)||e.externalUrl,externalUrl:e.externalUrl,experienceInfo:e.experienceInfo,queryParamOverrides:e.queryParamOverrides,display:e.canonicalName,pivotId:e.pivotId,context:e.context};this.staticRoutes.push(t)})}setDynamicRoutes(){return Object(a.b)(this,void 0,void 0,(function*(){const e=new l(this.onUpdateDynamicRoute.bind(this),this.config.dynamicRouteExperienceInfo);yield e.getDynamicPivotsFromDataConnector(this.config.dynamicRouteDataConnector)}))}onUpdateDynamicRoute(e){this.dynamicRoutes=e;for(const e of this.onUpdateRoutesCallbacks)e(this.dynamicRoutes)}}function g(e,t){if(!e)return"";if(t){return`/interest/${e.toLowerCase().replace(/\s/g,"").replace(/\//g,"-")}/${encodeURIComponent(t)}`}return f[e]||"/"+e}function y(e){return!!(e&&e.oldSelection&&e.newSelection)&&(!(!e.oldSelection||!e.oldSelection.pivotId)&&!(!e.newSelection||!e.newSelection.pivotId))}!function(e){e.MyFeed="myFeed",e.Personalize="personalize"}(p||(p={}));const f={myFeed:"/",personalize:"/personalize",interest:"/interest/*/:id"};var v;!function(e){e[e.Telemetry=0]="Telemetry",e[e.Monetization=1]="Monetization",e[e.LoadContent=2]="LoadContent",e[e.AfterLoadContent=3]="AfterLoadContent"}(v||(v={}));const w="selectedPivot";let R;const P=e=>R?(e&&R.setRoutes(e),R):(R=new m(e),R)},FaCY:function(e,t,o){"use strict";o.d(t,"a",(function(){return a}));var i=o("G82u");class a{}a.followedTopics=new i.a("FollowedTopics"),a.followedTopicsFailed=new i.a("FollowedTopicsFailedSignature"),a.recommendedTopics=new i.a("RecommendedTopics"),a.recommendedTopicsFailed=new i.a("RecommendedTopicsFailed"),a.topic=new i.a("Topic"),a.topicFailed=new i.a("TopicsFailed"),a.topics=new i.a("Topics"),a.topicsFailed=new i.a("TopicsFailed"),a.topicGroup=new i.a("TopicGroup"),a.topicGroupFailed=new i.a("TopicGroupFailed"),a.updateTopicFollowedState=new i.a("UpdateTopicFollowedState"),a.updateTopicFollowedStateFailed=new i.a("UpdateTopicFollowedStateFailed")},YS0M:function(e,t,o){"use strict";o.r(t),o.d(t,"TelemetryDataConnector",(function(){return u})),o.d(t,"TelemetryDataReducer",(function(){return h})),o.d(t,"ToolingInfo",(function(){return m}));var i=o("1w6q"),a=o("9J8d"),n=o("u5KZ"),c=o("w0HK"),s=o("loKy"),r=o("s9+9");const d="tp";var l=o("HDSB"),p=o("C4R5");class u extends i.a{constructor(e,t,o,i,d,u,h){super(e,t,o,i,d,u,h);const m=Object(c.a)(),g=m.getSelectedPivot();if(g&&g.telemetryPivotCategory){let e;e.page.pivot=g.telemetryPivotCategory,n.a.updatePageMetadata(e)}if(Object(l.a)()){const e=a.a.getInstance().rootReducer.connector(r.a.SharedState);e&&e.getCurrentState().useHistory?Object(p.d)().addSwitchListener(this.onPivotSwitch,s.a.Telemetry):m.addSwitchListener(this.onPivotSwitch,s.a.Telemetry)}}onPivotSwitch(e){let t;const o=e.newSelection;if(o&&(n.a.addOrUpdateCustomProperty(d,o.display),t={feed:{id:o.pivotId,name:o.display,type:"xfeed"===o.telemetryPageName?"category filter":void 0},page:{content:{topic:o.display},pivot:""}},o.telemetryPivotCategory&&(t.page.pivot=o.telemetryPivotCategory),n.a.updatePageMetadata(t)),e.oldSelection)return o.telemetryPageName&&(t.page.name=o.telemetryPageName),n.a.updatePageMetadata(t),void n.a.sendPageView(null,!1)}}class h{reduce(e,t){return{}}}const m={experienceConfigSchema:{}}}}]);